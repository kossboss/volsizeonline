
<html>
     <head>
        <title>VolSize Calc - Site Edition - v1.1</title>
        <script type="text/javascript">
            <!-- to hide script contents from old browsers
            //document.write("Welcome To VolSize Calc (by: kossboss)");

            // end hiding contents from old browsers  -->
            function runScript(e) {
                if (e.keyCode == 13) {

                    calc();

                    return false;
                }
            }

            function checknum(x) {
                var anum = /(^\d+$)|(^\d+\.\d+$)/;
                if (anum.test(x)) testresult = true;
                else {
                    //alert("Please input a valid number!")
                    testresult = false;
                }
                return (testresult);
            }



            function contains(a, obj) {
                var i = a.length;
                while (i--) {
                    if (a[i] === obj) {
                        return true;
                    }
                    // alert(i);
                }
                return false;
            }

            function indexofd(a, obj) {
                var i = a.length;
                while (i--) {
                    if (a[i] === obj) {
                        return i;
                    }
                    // alert(i);
                }
                return -1;
            }


            //// MAIN FUNCITON
            function calc() {
                var divobj0 = document.getElementById('results0');
                var divobj1 = document.getElementById('results1');
                var divobj2 = document.getElementById('results2');
                var divobj3 = document.getElementById('results3');
                var divobj4 = document.getElementById('results4');
                divobj0.style.display = 'block';
                divobj0.innerHTML = "";
                divobj1.style.display = 'block';
                divobj1.innerHTML = "";
                divobj2.style.display = 'block';
                divobj2.innerHTML = "";
                divobj3.style.display = 'block';
                divobj3.innerHTML = "";
                divobj4.style.display = 'block';
                divobj4.innerHTML = "";
                // constants
                var intel = 4.512;
                var arm = intel;
                var sparc = arm / 2;

                // arch
                var theForm = document.forms["volform"];
                var selecteda = theForm.elements["selectedarch"];
                var sarch;
                var osandswap = 0;
                for (var i = 0; i < selecteda.length; i++)

                {

                    if (selecteda[i].checked) {

                        sarch = selecteda[i].value;

                        if (sarch == "intel") {
                            osandswap = intel;
                        } else if (sarch == "arm") {
                            osandswap = arm;
                        } else if (sarch == "sparc") {
                            osandswap = sparc;
                        }

                        break;
                    }
                }

                //arch


                var d1 = parseFloat(document.getElementById('dr1').value);
                var d2 = parseFloat(document.getElementById('dr2').value);
                var d3 = parseFloat(document.getElementById('dr3').value);
                var d4 = parseFloat(document.getElementById('dr4').value);
                var d5 = parseFloat(document.getElementById('dr5').value);
                var d6 = parseFloat(document.getElementById('dr6').value);
                var d7 = parseFloat(document.getElementById('dr7').value);
                var d8 = parseFloat(document.getElementById('dr8').value);
                var d9 = parseFloat(document.getElementById('dr9').value);
                var d10 = parseFloat(document.getElementById('dr10').value);
                var d11 = parseFloat(document.getElementById('dr11').value);
                var d12 = parseFloat(document.getElementById('dr12').value);
                var snapshot = parseFloat(document.getElementById('snapsize').value);







                var drives = new Array();
                drives[0] = d1;
                drives[1] = d2;
                drives[2] = d3;
                drives[3] = d4;
                drives[4] = d5;
                drives[5] = d6;
                drives[6] = d7;
                drives[7] = d8;
                drives[8] = d9;
                drives[9] = d10;
                drives[10] = d11;
                drives[11] = d12;

                var drivesizes = 0; // number of unique drive sizes
                var ds = new Array();
                //alert("10 is here: " + contains(drives,123));

                var i1 = 0;
                var islegit = true;

                var numnum = 0;
                for (var i = 0; i < 12; i++) {


                    islegit = checknum(drives[i]);

                    if (islegit == false) {
                        var numofbaddrive = i + 1;
                        divobj0.style.display = 'block';
                        divobj1.style.display = 'block';
                        divobj0.innerHTML = "<b>FAIL: Need to pick a number for a drive size</b>";
                        divobj1.innerHTML = "Drive " + numofbaddrive + " is not given a size with a number. You must enter a legit number. Please enter a number in units of GB [in base 10].";

                        return;
                    }



                    if (drives[i] > 0) {
                        numnum++;
                    }


                    //if(contains(ds,drives[i])==false )	{ //
                    //	if(checknum(drives[i])){
                    if (drives[i] != 0) {
                        //	 alert(i1 + " new drive:" + drives[i]);
                        ds[i1] = drives[i];
                        i1++;
                    }
                    //	}else{
                    //		alert("Please pick a legit drive size - numbers only: for example: for a 1 TB drive I would type 1000")
                    //		var divobj0 = document.getElementById('results0');
                    //		divobj0.style.display='block';
                    //		divobj0.innerHTML = "FAIL: Need to pick a number for a drive size";
                    // return;
                    //	}
                    //  if drives[i]
                }

                //alert("hi");
                ds.sort(function (a, b) {
                    return a - b;
                });

                //var inds="hehehe"; var val1;
                //for(var i=0; i<ds.length; i++)
                //{
                //val1 = ds[i];
                // inds=inds+" " + val1;
                //}
                //alert(inds);
                // 0 20 60 20 30 50 40 100
                // now ds has all the unique drives need to sort them though

                var hist = new Array();
                var chist = new Array();
                var chist5 = new Array();
                var chist6 = new Array();
                //init arrays
                var ds_size = ds.length;
                for (var g = 0; g < ds_size; g++) {
                    hist[g] = 0;
                    chist[g] = 0; //chunks
                    chist5[g] = -1; // for raid5 calc
                    chist6[g] = -2; // for raid6 calc
                }
                // alert("ihello");
                //alert("hello");
                //go thru all drives
                var indofdrive;
                for (var i = 0; i < 12; i++) {
                    indofdrive = indexofd(ds, drives[i]);
                    // alert("d:" +drives[i]+ " is at "+ indofdrive);
                    if (indofdrive != -1) {
                        hist[indofdrive]++;
                        for (var j = 0; j <= indofdrive; j++) {
                            chist[j]++;
                            chist5[j]++;
                            chist6[j]++;

                        }

                    }
                    ////  if drives[i]
                }
                ///TESTS
                //var inds="hist"; 
                //var inds1="chist";
                //var inds2="chist5"; 
                // var inds3="chist6"; 
                //for(var i=0; i<hist.length; i++)
                //	{

                //	  inds=inds+" " + hist[i];
                //	   inds1=inds1+" " + chist[i];
                //		inds2=inds2+" " + chist5[i];
                //		 inds3=inds3+" " + chist6[i];

                //	}
                //alert(inds + "|" + inds1+ "|" + inds2 + "|" + inds3);
                ///END TEST
                var sum10gb = 0;
                var val1;

                for (var i = 0; i < drives.length; i++) {
                    if (drives[i] > 0) { //**
                        val1 = drives[i];
                        sum10gb = sum10gb + val1;
                    }

                }
                //alert("sum10gb after calc of drives:" + sum10gb + " numnum of drives" + numnum);
                var cfgb2gb = 0.93132257461;
                var cftb2tb = 0.90949470177;
                var sum2gb = sum10gb * cfgb2gb;
                var sum10tb = sum10gb / 1000;
                var sum2tb = sum2gb / 1024;


                var dstart = 0;
                var dend = 0;
                var diffd = 0;
                var q = 0;
                var q10 = 0;
                var q2 = 0;
                var toraid5 = 0;
                var toraid6 = 0;
                for (var c = 0; c < ds_size; c++) {
                    if (c == 0) {
                        dstart = 0;
                    } else {
                        dstart = ds[c - 1];
                    }
                    dend = ds[c];
                    diffd = dend - dstart;
                    //   alert("c: " + c + " dstart: " + dstart + " dend:" + dend);
                    q = chist[c];
                    //	alert("q:" + q);
                    q10 = (q * diffd) / 1000;
                    //	alert("q10:" + q10);
                    q2 = (q * diffd * cfgb2gb) / 1024;
                    //	alert("q2:" + q2);
                    // alert("q2:" + q2 + "  q10:" + q10);
                    if ((chist5[c]) > 0) //if negative or zero dont count
                    {
                        toraid5 += chist5[c] * diffd;
                    }
                    if ((chist6[c]) > 0) //if negative or zero dont count
                    {
                        toraid6 += chist6[c] * diffd;
                    }

                }
				var toraid5tb=toraid5/1000;  //both in base 10
				var toraid6tb=toraid6/1000;

                var correctional1 = 1.01594;
                var correctional5 = 1.01594;
                var correctional6 = 1.01594;
                var raid_overhead_percent = 2;
                var raid_overhead = raid_overhead_percent / 100;

                var spaceR52 = toraid5 * cfgb2gb;
                var spaceR52Tb = spaceR52 / 1024;


                var spaceR62 = toraid6 * cfgb2gb;
                var spaceR62Tb = spaceR62 / 1024;
                //var totalos = osSize * used;
                //var totalswap = swapSize * used;
                //alert("tocalcs");
                var totalosandswap = osandswap * numnum; // totalos + totalswap;
                var afteros5 = spaceR52 - totalosandswap;
                var afteros6 = spaceR62 - totalosandswap;
                var afterOverhead5 = afteros5 * (1 - raid_overhead);
                var afterOverhead6 = afteros6 * (1 - raid_overhead);


                var final5Gb = (afterOverhead5 - snapshot) * correctional5;
                var final6Gb = (afterOverhead6 - snapshot) * correctional6;
                var final5Tb = (final5Gb / 1024) * correctional5;
                var final6Tb = (final6Gb / 1024) * correctional6;
                // alert(final5Tb + "=5=6= " + final6Tb);
                //alert("final5: " + final5Tb);


                // 0 20 60 20 30 50 40 100



                //int[] hist = new int[drivessize];
                //           int[] chist = new int[drivessize];
                //          int[] chist5 = new int[drivessize];
                //         int[] chist6 = new int[drivessize];


                //       for (int g = 0; g < drivessize; g++)
                //      {
                ///         hist[g] = 0;
                //       chist[g] = 0;
                //      chist5[g] = -1;
                //     chist6[g] = -2;
                // }

                //alert(drives[0]);



                //raid5tb= 500;
                //raid6tb=1000;
                //alert(sum10gb + "   " + numnum );
				var extrabit ="";
				if (numnum == 2 || numnum==3)
				{
					extrabit = "<strong>  <------ Ignore these, Raid 6, values with only 2 or 3 drives, please refer to above, Raid 5, value instead</strong>"
				}


                if (numnum > 1) {
                    divobj0.style.display = 'block';
                    divobj0.innerHTML = "Given Size [base 10]: " + sum10gb.toFixed(3) + " GB = " + sum10tb.toFixed(3) + " TB";

                    divobj1.style.display = 'block';
                    divobj1.innerHTML = "Given Size [base 2]: " + sum2gb.toFixed(3) + " GB = " + sum2tb.toFixed(3) + " TB";


                    divobj2.style.display = 'block';
                    divobj2.innerHTML ="<strong>Useable Disk Space</strong> with Raid 5 [base 10]: " + toraid5.toFixed(3) + " GB = <strong>" + toraid5tb.toFixed(3) + " TB</strong><br/>"+"<strong>Useable Disk Space</strong> with Raid 6 [base 10]: " + toraid6.toFixed(3) + " GB = <strong>" + toraid6tb.toFixed(3) + " TB</strong>"+extrabit+ "<br/><strong>Final Volume Size</strong> with Raid 5 [base 2]: " + final5Gb.toFixed(3) + " GB = <strong>" + final5Tb.toFixed(3) + " TB</strong>";


                    divobj3.style.display = 'block';
                    divobj3.innerHTML = "<strong >Final Volume Size</strong> with Raid 6 [base 2] : " + final6Gb.toFixed(3) + " GB = <strong>" + final6Tb.toFixed(3) + " TB</strong>" + extrabit;

                    divobj4.style.display = 'block';
                    divobj4.innerHTML = "Given: " + numnum + " drives";
                } else { //if numnum =1 disk just 1 disk
                    var onediskgb = 0;
                    var onedisktb = 0;
                    onediskgb = ((sum2gb - totalosandswap) * (1 - raid_overhead) - snapshot) * correctional1;
                    onedisktb = onediskgb / 1024;

                    divobj0.style.display = 'block';
                    divobj0.innerHTML = "Given Size [base 10]: " + sum10gb.toFixed(3) + " GB = " + sum10tb.toFixed(3) + " TB";

                    divobj1.style.display = 'block';
                    divobj1.innerHTML = "Given Size [base 2]: " + sum2gb.toFixed(3) + " GB = " + sum2tb.toFixed(3) + " TB";

					divobj2.style.display = 'block';
                    divobj2.innerHTML = "" ;

                    divobj3.style.display = 'block';
                    divobj3.innerHTML = "<strong >Final Volume Size</strong> [base 2] with 1 disk: " + onediskgb.toFixed(3) + " GB = <strong>" + onedisktb.toFixed(3) + " TB</strong>";


                   
                    divobj4.style.display = 'block';
                    divobj4.innerHTML = "Given: 1 drive";
                }
            }
        </script>
    </head>
    
    <body>
        <form action="" id="volform" onsubmit="return false;">
            <fieldset>
                <legend><strong>Welcome To: VolSize Calc - Site Edition - v1.1 (by: kossboss)</strong ></legend>
	<br/>
	<strong ><label>NOTE: The results come out pretty close, but you cannot sue us if they dont match </label> <br/><br/> </strong>

                    <label>Start By Selecting your READYNAS Setup</label>
                    <br/>
                    <br/>
                    <label><b>(Step 1)</b> Architecture Type:</label>
                    <input type="radio" name="selectedarch"
                    value="intel" onclick="calc()" checked="true" />Intel / X86
                    <input type="radio" name="selectedarch" value="arm" onclick="calc()"
                    />ARM
                    <input type="radio" name="selectedarch" value="sparc" onclick="calc()"
                    />SPARC
                    <br/>
                    <br/>
                    <label><b>(Step 2)</b> Snapshot Size (between 0 and 100gb) [GB]:</label>
                    <input type="text"
                    id="snapsize" name="snapsize" value="0" onclick="calc()" onkeypress="return runScript(event)"
                    />
                    <br/>
                    <br/>
                    <label><b>(Step 3)</b> Fill the Slots with Drive Sizes (Using drive sizes that the manufacturers
                        reports, so in base 10):</label>
                    <br/><br/>
					<label><strong>Note 1:</strong> Use drive sizes that are listed on the compatability list on Readynas.com</label>
                    <br/>
                    <label>So far those sizes [in GB base 10] that are supported: 500, 750, 1000, 1500, 2000,
                        3000</label>
                    <br/>
                    <label>In this app you can put in other sizes but Netgear only recommends and
                        support drives listed in the compatability list</label>
                    <br/>
                    <br/>
					 <label><strong>Note 2:</strong> If you have a HOT SPARE, leave it out of the calculation, it picks the biggest drive and 0s it on the calculation.</label>
					 <br/>
					 <label> To emulate a HOT SPARE - For example in a system with three 1TB and one 2TB drive. Just put into the app the three 1TB drives.</label>
					<br/>
                    <br/>
					<label><b>To clear all the values just Refresh the page or press F5 on your keyboard</b></label><br/>
                    <label>Drive 1 [GB]:</label>
                    <input type="text" id="dr1" name="dr1" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <label>Drive 2 [GB]:</label>
                    <input type="text" id="dr2" name="dr2" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <label>Drive 3 [GB]:</label>
                    <input type="text" id="dr3" name="dr3" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <label>Drive 4 [GB]:</label>
                    <input type="text" id="dr4" name="dr4" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <label>Drive 5 [GB]:</label>
                    <input type="text" id="dr5" name="dr5" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <label>Drive 6 [GB]:</label>
                    <input type="text" id="dr6" name="dr6" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <label>Drive 7 [GB]:</label>
                    <input type="text" id="dr7" name="dr7" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <label>Drive 8 [GB]:</label>
                    <input type="text" id="dr8" name="dr8" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <label>Drive 9 [GB]:</label>
                    <input type="text" id="dr9" name="dr9" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <label>Drive 10 [GB]:</label>
                    <input type="text" id="dr10" name="dr10" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <label>Drive 11 [GB]:</label>
                    <input type="text" id="dr11" name="dr11" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <label>Drive 12 [GB]:</label>
                    <input type="text" id="dr12" name="dr12" value="0"
                    onclick="calc()" onkeypress="return runScript(event)" />
                    <br/>
                    <br/>
                    <label><b>(Step 4)</b> Press this </label>
                    <input type="button" onclick="calc();" value="Calculate">
					<label>to calculate the result or just press <b>Enter</b>:</label>
                    <br/>
                    <br/>
                    
					<label><strong>==RESULTS (will go below)==</strong></label>
                    <br/>
                    <div id="results4"></div>
                    <div id="results0"></div>
                    <div id="results1"></div>
                    <div id="results2"></div>
                    <div id="results3"></div>
					
                    <br/>
                    <br/>
					<label><strong><strong>Note 3:</strong> What goes into the Calculation?</strong></label><br/>
					<label>Each calculation takes into account OS & SWAP partition costs per each disk, the snapshot size across the whole volume, and the raid-overhead across the whole volume.</label>
					<br/>
					<label>The biggest cost of volume size is in conversion from base 10 size to base 2. Drive manufacturers label 1 TB but actually mean 0.9 TB based on the base 2 to 10 conversion. </label>
					<br/><br/>
					<label><strong><strong>Note 4:</strong> What values to read?</strong></label><br/>
					<label>* With 1 disk - the given "Final Volume Size" value is correct.</label>
					 <br/>
					<label>* With 2 disks - XRAID converges to RAID 1, read the "Final Volume Size with Raid 5" for correct the result. (Why? programmatically RAID5 and RAID1 calculations are equal and correct with this algorithm)</label>
					 <br/>
					<label>* With 3 disks - XRAID converges to RAID 5, read the "Final Volume Size with Raid 5" calculation for correct result.</label>
					 <br/>
					<label>* With 4+ disks - XRAID converges to RAID 5 or 6 based on your selection on the Volume Settings tab of Frontview, so read "Final Volume Size with Raid 5" or "... 6" depending on your setup.</label>
					<br/><br/>
					<label><strong>Special Thanks goes out to:</strong></label><br/>
					<a href="http://www.readynas.com/kb/faq/boot/why_is_my_volume_capacity_is_lower_than_expected">NETGEAR KB - Chirpas Article</a>
					<br/><br/>
					<label><strong>Read this if confused on base 2 and base 10 disk drive sizes:</strong></label><br/>
					<a href="http://www.howtogeek.com/123268/windows-hard-drive-wrong-capacity/">Why Your Hard Drive Shows Less Space Than Advertised</a>
					
					
					
            </fieldset>
		</form>
    </body>

</html>